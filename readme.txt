Добрый день.
Не совсем понял правила разбора строки лога и формирование данных таблиц, поэтому сделал по упрощенной схеме.
В коде не использовал регулярные выражения по причине трудоемкости поддержки такого кода.
Шаблон страницы с результатами так же не использовал, всю страницу формирует db_gpb_log.pl

С уважением,
Голдобин Михаил.